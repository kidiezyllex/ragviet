Mô tả chức năng: Chức năng tìm kiếm người dùng cho phép quản trị viên (Admin) tìm kiếm thông tin người dùng trong hệ thống bằng cách nhập từ khóa tìm kiếm (username, email hoặc user_id). Hệ thống sẽ trả về danh sách người dùng phù hợp với từ khóa tìm kiếm.
Trình tự thực hiện:
1. Quản trị viên (Admin) nhập từ khóa tìm kiếm (username, email hoặc user_id) vào giao diện quản trị (Admin UI).
2. Giao diện (Admin UI) gửi yêu cầu GET đến Backend API (SearchUserView) kèm theo từ khóa tìm kiếm (search_query) và session_id.
3. Backend API gửi yêu cầu kiểm tra session tới AuthManager với session_id.
4. AuthManager gửi truy vấn kiểm tra session trong Database (MongoDB).
Trường hợp 1: Session không hợp lệ hoặc chưa đăng nhập
5. Database trả về kết quả None cho AuthManager.
6. AuthManager trả về kết quả None cho Backend API.
7. Backend API trả về thông báo "Vui lòng đăng nhập" cho FrontEnd.
8. Giao diện hiển thị thông báo lỗi yêu cầu đăng nhập cho quản trị viên.
Trường hợp 2: Session hợp lệ
5. Database trả về user object cho AuthManager.
6. AuthManager trả về user object cho Backend API.
7. Backend API tiến hành kiểm tra quyền admin của người dùng (kiểm tra user có role="admin" hoặc is_admin=true hay không).
Trường hợp 2.1: Không có quyền admin
8. Backend API trả về thông báo "Không có quyền truy cập" cho FrontEnd.
9. Giao diện hiển thị thông báo lỗi không có quyền cho quản trị viên.
Trường hợp 2.2: Có quyền admin
8. Backend API tiến hành kiểm tra xem từ khóa tìm kiếm có rỗng hay không.
Trường hợp 2.2.1: Từ khóa tìm kiếm rỗng
9. Backend API trả về thông báo "Vui lòng nhập từ khóa tìm kiếm" cho FrontEnd.
10. Giao diện hiển thị thông báo lỗi cho quản trị viên.
Trường hợp 2.2.2: Có từ khóa tìm kiếm
9. Backend API gửi yêu cầu tìm kiếm người dùng tới Database (MongoDB) với từ khóa tìm kiếm.
10. Database tiến hành tìm kiếm trong collection users theo username, email hoặc user_id (sử dụng regex hoặc exact match).
Trường hợp 2.2.2.1: Không tìm thấy người dùng nào
11. Database trả về danh sách rỗng cho Backend API.
12. Backend API trả về kết quả thành công với danh sách rỗng và thông báo "Không tìm thấy người dùng nào" cho FrontEnd.
13. Giao diện hiển thị thông báo không tìm thấy cho quản trị viên.
Trường hợp 2.2.2.2: Tìm thấy người dùng
11. Database trả về danh sách user objects phù hợp với từ khóa tìm kiếm cho Backend API.
12. Backend API tiến hành loại bỏ thông tin nhạy cảm (password_hash, ...) khỏi danh sách người dùng.
13. Backend API tiến hành format dữ liệu trả về (chuẩn hóa format, thêm thông tin bổ sung nếu cần).
14. Backend API trả về kết quả thành công kèm theo danh sách người dùng và tổng số lượng cho FrontEnd.
15. Giao diện hiển thị danh sách người dùng trong bảng hoặc danh sách với các thông tin cơ bản (username, email, user_id, created_at, is_active, ...).
16. Giao diện hiển thị kết quả tìm kiếm với thông tin người dùng cho quản trị viên.
Kết quả: Quá trình tìm kiếm người dùng thành công. Quản trị viên có thể xem danh sách người dùng phù hợp với từ khóa tìm kiếm và thực hiện các thao tác quản trị tiếp theo.

