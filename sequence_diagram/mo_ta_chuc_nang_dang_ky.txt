Mô tả chức năng: Chức năng đăng ký tài khoản cho phép người dùng tạo tài khoản mới trong hệ thống với thông tin username, email và mật khẩu. Sau khi đăng ký thành công, hệ thống sẽ tự động đăng nhập người dùng.
Trình tự thực hiện:
1. Người dùng nhập thông tin đăng ký (username, email, password, confirm_password) vào giao diện đăng ký (Gradio UI).
2. Giao diện (Gradio UI) gửi yêu cầu POST đến Backend API (RegisterView) kèm theo thông tin đăng ký.
3. Backend API tiến hành kiểm tra xem mật khẩu và mật khẩu xác nhận có khớp nhau hay không.
Trường hợp 1: Mật khẩu xác nhận không khớp
4. Backend API trả về thông báo lỗi "Mật khẩu xác nhận không khớp" cho FrontEnd.
5. Giao diện hiển thị thông báo lỗi cho người dùng.
Trường hợp 2: Mật khẩu xác nhận khớp
4. Backend API gửi yêu cầu đăng ký tới AuthManager với thông tin username, email và password.
5. AuthManager tiến hành kiểm tra validation (username, email, password không rỗng, password phải có ít nhất 6 ký tự).
Trường hợp 2.1: Thông tin không hợp lệ
6. AuthManager trả về kết quả lỗi validation cho Backend API.
7. Backend API trả về thông báo lỗi cho FrontEnd.
8. Giao diện hiển thị thông báo lỗi cho người dùng.
Trường hợp 2.2: Thông tin hợp lệ
6. AuthManager gửi yêu cầu tạo user tới Database (MongoDB) với thông tin username, email và password đã được hash.
7. Database tiến hành kiểm tra xem email hoặc username đã tồn tại trong hệ thống hay chưa.
Trường hợp 2.2.1: Email/username đã tồn tại
8. Database trả về kết quả None cho AuthManager.
9. AuthManager trả về thông báo "Email hoặc username đã tồn tại" cho Backend API.
10. Backend API trả về thông báo lỗi cho FrontEnd.
11. Giao diện hiển thị thông báo lỗi cho người dùng.
Trường hợp 2.2.2: Tạo user thành công
8. Database tạo user mới và trả về user object cho AuthManager.
9. AuthManager trả về kết quả đăng ký thành công cho Backend API.
10. Backend API tiến hành tự động đăng nhập người dùng bằng cách gửi yêu cầu login tới AuthManager với email và password.
11. AuthManager gửi yêu cầu xác thực mật khẩu tới Database.
12. Database xác thực mật khẩu và trả về user object cho AuthManager.
13. AuthManager tạo session_id mới cho người dùng.
14. AuthManager gửi yêu cầu lưu session vào Database.
15. Database lưu session và trả về kết quả thành công cho AuthManager.
16. AuthManager trả về thông tin session (session_id, access_token, user) cho Backend API.
17. Backend API gửi yêu cầu tạo chat session mới tới Database với user_id.
18. Database tạo chat session và trả về chat_session_id cho Backend API.
19. Backend API trả về kết quả đăng ký thành công kèm theo thông tin session, user và chat_session_id cho FrontEnd.
20. Giao diện lưu session vào localStorage và hiển thị thông báo thành công cùng với thông tin người dùng đã đăng nhập.
Kết quả: Quá trình đăng ký tài khoản thành công. Người dùng được tự động đăng nhập và có thể sử dụng các chức năng của hệ thống.

